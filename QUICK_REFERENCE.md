# ğŸš€ RAG ç³»ç»Ÿå¿«é€Ÿå‚è€ƒ

## ç³»ç»Ÿå·²å®Œå…¨ä¿®å¤ âœ…

### å‰ç«¯æ˜¾ç¤ºé—®é¢˜ â†’ å·²è§£å†³ âœ…
- **é—®é¢˜**: "æˆ‘æ— æ³•æ ¹æ®ç°æœ‰çŸ¥è¯†åº“ä¸­çš„ä¿¡æ¯å›ç­”è¿™ä¸ªé—®é¢˜"
- **åŸå› **: æ–‡æ¡£å…ƒæ•°æ®ä¸¢å¤±
- **ä¿®å¤**: [rag_assistant.py](rag_assistant.py#L356-L364) Document è½¬æ¢é€»è¾‘
- **ç»“æœ**: å‰ç«¯ç°åœ¨æ­£ç¡®æ˜¾ç¤ºæ¥æºå’Œå†…å®¹

## ä½¿ç”¨æ–¹æ³•

### 1ï¸âƒ£ å¯åŠ¨ç³»ç»Ÿ

```bash
cd /Users/apple/Documents/AI/RAGçŸ¥è¯†åº“

# å¯åŠ¨ Ollama (å¦‚æœè¿˜æœªè¿è¡Œ)
ollama serve &

# å¯åŠ¨åç«¯ API (æ–°ç»ˆç«¯)
source .venv/bin/activate
python app_api.py

# å¯åŠ¨å‰ç«¯ (ç¬¬ä¸‰ä¸ªç»ˆç«¯)
cd frontend
npm run dev
```

### 2ï¸âƒ£ å‰ç«¯è®¿é—®
- æ‰“å¼€æµè§ˆå™¨: `http://localhost:5173`
- è¾“å…¥é—®é¢˜ï¼Œå¦‚ "æ·±åº¦å­¦ä¹ çš„ä¸»è¦æ¶æ„æœ‰å“ªäº›ï¼Ÿ"
- ç³»ç»Ÿä¼šè¿”å›å®Œæ•´ç­”æ¡ˆå’Œæ¥æºä¿¡æ¯

### 3ï¸âƒ£ æµ‹è¯•éªŒè¯

```bash
# æµ‹è¯•æ£€ç´¢åŠŸèƒ½
python test_retrieve_fix.py

# æµ‹è¯• API å®Œæ•´æµç¨‹
python test_api_fix.py

# æµ‹è¯• simple_rag (å¿«é€Ÿ)
python simple_rag.py
```

## ç³»ç»Ÿæ¶æ„

```
å‰ç«¯ (Vue)
    â†“
API (/api/query) [app_api.py]
    â†“
RAG Assistant [rag_assistant.py]
    â”œâ”€ æŸ¥è¯¢ä¼˜åŒ–
    â”œâ”€ æ–‡æ¡£æ£€ç´¢ [rag_assistant.retrieve_documents()]
    â””â”€ LLM ç”Ÿæˆ (Ollama)
        â†“
    å‘é‡æ•°æ®åº“ (Chroma) [vector_store.py]
        â†“
    æ–‡æ¡£åº“ (./documents/)
```

## æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | åŠŸèƒ½ | ä¿®å¤å†…å®¹ |
|-----|-----|---------|
| [rag_assistant.py](rag_assistant.py) | RAG æ ¸å¿ƒé€»è¾‘ | æ·»åŠ  Document è½¬æ¢é€»è¾‘ (L356-364) |
| [app_api.py](app_api.py) | FastAPI åç«¯ | è°ƒè¯•æ—¥å¿— |
| [vector_store.py](vector_store.py) | å‘é‡æ•°æ®åº“ | æ— æ”¹åŠ¨ |
| [simple_rag.py](simple_rag.py) | ç®€åŒ– RAG | æµ‹è¯•ç”¨ |
| [config.py](config.py) | é…ç½®ç®¡ç† | ä½¿ç”¨ Ollama |

## é…ç½®ä¿¡æ¯

```env
# .env æ–‡ä»¶
MODEL_PROVIDER=ollama
OLLAMA_API_URL=http://localhost:11434
OLLAMA_MODEL=gemma3:4b

# å¯ç”¨æ¨¡å‹
- gemma3:4b (å½“å‰ä½¿ç”¨ï¼Œå¿«é€Ÿ)
- llama3.2:latest (æ›´å¼ºå¤§)
- qwen3-coder (ç¼–ç¨‹èƒ½åŠ›)
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: å‰ç«¯è¯´"æ— æ³•å›ç­”"æ€ä¹ˆåŠï¼Ÿ
**A**: 
1. ç¡®ä¿ Ollama æ­£åœ¨è¿è¡Œ: `curl http://localhost:11434/api/tags`
2. æ£€æŸ¥ API æ—¥å¿—: `tail -f /tmp/api.log`
3. é‡å¯ API æœåŠ¡

### Q: å“åº”å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ
**A**: 
1. è¿™æ˜¯æ­£å¸¸çš„ï¼ˆé¦–æ¬¡æŸ¥è¯¢ 30-80 ç§’ï¼‰
2. å¯ä»¥åˆ‡æ¢åˆ°æ›´å°çš„æ¨¡å‹: `ollama pull gemma2:2b`
3. æˆ–ä½¿ç”¨ GPU: `pip install torch`

### Q: å¦‚ä½•æ·»åŠ æ–°æ–‡æ¡£ï¼Ÿ
**A**:
1. æŠŠæ–‡ä»¶æ”¾åˆ° `./documents/` ç›®å½•
2. åˆ é™¤ `./vector_db/` ç›®å½•
3. é‡å¯ç³»ç»Ÿï¼Œä¼šè‡ªåŠ¨é‡å»ºç´¢å¼•

### Q: å¦‚ä½•ä¼˜åŒ–æœç´¢ç»“æœï¼Ÿ
**A**:
1. åœ¨ [rag_assistant.py](rag_assistant.py#L130-L154) ä¸­ç¼–è¾‘ `optimize_query()` æ–¹æ³•
2. æ·»åŠ æ›´å¤šæŸ¥è¯¢ä¼˜åŒ–è§„åˆ™
3. ä¾‹å¦‚: ç”¨æˆ·æŸ¥è¯¢"DLæ¶æ„" â†’ è½¬æ¢ä¸º"CNN RNN Transformer"

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|-----|-----|------|
| å‘é‡æ£€ç´¢ | <100ms | ä»å‘é‡æ•°æ®åº“æŸ¥è¯¢ |
| LLM ç”Ÿæˆ | 30-80ç§’ | Ollama åœ¨ CPU ä¸Šç”Ÿæˆ |
| æ€»å“åº”æ—¶é—´ | 30-80ç§’ | ä¸»è¦æ—¶é—´æ¶ˆè€—åœ¨ LLM |
| æ”¯æŒçš„æŸ¥è¯¢ | æ— é™åˆ¶ | æ‰€æœ‰ç±»å‹çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢ |

## âœ¨ æœ€è¿‘ä¿®å¤æ€»ç»“

```
é—®é¢˜é“¾:
1. å‰ç«¯æ˜¾ç¤º "æ— æ³•æ ¹æ®çŸ¥è¯†åº“å›ç­”"
   â†“
2. è¯Šæ–­å‘ç° API è¿”å› "æœªçŸ¥æ¥æº"
   â†“
3. API è·å–æ–‡æ¡£æ—  metadata
   â†“
4. retrieve_documents è¿”å›å­—ç¬¦ä¸²è€Œé Document
   â†“
5. Chroma.get() è¿”å› dict æ ¼å¼ï¼Œæœªè½¬æ¢
   â†“
âœ… ä¿®å¤: æ·»åŠ  Document è½¬æ¢é€»è¾‘

ä¿®å¤å‰: 
  æ£€ç´¢åˆ°: ['å­—ç¬¦ä¸²1', 'å­—ç¬¦ä¸²2', ...]
  æ¥æº: æœªçŸ¥æ¥æº
  å‰ç«¯: æ— æ³•å›ç­”

ä¿®å¤å:
  æ£€ç´¢åˆ°: [Document(...), Document(...), ...]
  æ¥æº: documents/æœºå™¨å­¦ä¹ å…¥é—¨.md
  å‰ç«¯: âœ… å®Œæ•´ç­”æ¡ˆ + æ¥æº
```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

1. æŸ¥çœ‹æ—¥å¿—: `tail -f /tmp/api.log`
2. è¿è¡Œæµ‹è¯•: `python test_api_fix.py`
3. æ£€æŸ¥é…ç½®: `python -c "from config import Config; print(Config.__dict__)"`

---

**ä¸Šæ¬¡æ›´æ–°**: 2025å¹´12æœˆ20æ—¥  
**ç³»ç»Ÿç‰ˆæœ¬**: v1.0 (å®Œå…¨ä¿®å¤)  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
